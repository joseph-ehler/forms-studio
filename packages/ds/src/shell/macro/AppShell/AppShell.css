/**
 * AppShell Structural CSS
 * 
 * Grid-based layout, no colors/typography (tokens drive visuals elsewhere).
 * Publishes structural frame only; Flowbite components provide the skin.
 */

/* ============================================
   BASE GRID LAYOUT
   ============================================ */

.app-shell {
  min-block-size: 100dvh;
  display: grid;
  grid-template-areas:
    "header header"
    "nav    main"
    "footer footer";
  grid-template-columns: var(--shell-nav-w, 280px) 1fr;
  grid-template-rows: var(--shell-header-h, 56px) 1fr auto;
}

/* Dock at bottom */
.app-shell[data-dock-position="bottom"] {
  grid-template-areas:
    "header header"
    "nav    main"
    "dock   dock"
    "footer footer";
  grid-template-rows: var(--shell-header-h, 56px) 1fr var(--shell-dock-size, 0px) auto;
}

/* ============================================
   SLOT PLACEMENT
   ============================================ */

.app-shell-header {
  grid-area: header;
  position: sticky;
  inset-block-start: 0;
  z-index: var(--ds-z-sticky, 60);
}

.app-shell-nav {
  grid-area: nav;
  min-inline-size: 0;
  overflow-y: auto;
  overflow-x: hidden;
}

.app-shell-main {
  grid-area: main;
  min-inline-size: 0;
  container-type: inline-size;
  container-name: main;
  overflow-y: auto;
}

.app-shell-panels {
  /* Overlay host - positioned over main */
  grid-area: main;
  pointer-events: none;
  position: relative;
  z-index: var(--ds-z-panel, 70);
}

.app-shell-panels > * {
  pointer-events: auto;
}

.app-shell-dock {
  grid-area: dock;
}

.app-shell-footer {
  grid-area: footer;
}

/* ============================================
   TABLET/MOBILE: Nav Off-Canvas
   ============================================ */

:root[data-shell-mode="tablet"] .app-shell,
:root[data-shell-mode="mobile"] .app-shell {
  grid-template-areas:
    "header"
    "main"
    "dock"
    "footer";
  grid-template-columns: 1fr;
}

:root[data-shell-mode="tablet"] .app-shell-nav,
:root[data-shell-mode="mobile"] .app-shell-nav {
  position: fixed;
  inset-block: var(--shell-header-h, 56px) 0;
  inset-inline-start: 0;
  inline-size: min(100%, 320px);
  block-size: calc(100dvh - var(--shell-header-h, 56px));
  transform: translateX(-100%);
  transition: transform 200ms ease;
  z-index: calc(var(--ds-z-sticky, 60) + 1);
  background: var(--ds-color-surface-base, white);
  box-shadow: var(--ds-shadow-overlay-md, 0 4px 12px rgba(0, 0, 0, 0.1));
}

:root[data-shell-mode="tablet"][data-nav-open="true"] .app-shell-nav,
:root[data-shell-mode="mobile"][data-nav-open="true"] .app-shell-nav {
  transform: translateX(0);
}

/* ============================================
   TABLET/MOBILE: Scrim/Backdrop
   ============================================ */

:root[data-shell-mode="tablet"][data-nav-open="true"]::before,
:root[data-shell-mode="mobile"][data-nav-open="true"]::before {
  content: '';
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: var(--ds-z-sticky, 60);
  animation: fade-in 200ms ease;
}

@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* ============================================
   PANELS: Right Overlay on Tablet/Mobile
   ============================================ */

:root[data-shell-mode="tablet"] .app-shell-panels > *,
:root[data-shell-mode="mobile"] .app-shell-panels > * {
  position: fixed;
  inset-block-start: var(--shell-header-h, 56px);
  inset-inline-end: 0;
  block-size: calc(100dvh - var(--shell-header-h, 56px));
  inline-size: var(--shell-panels-w, 360px);
  max-inline-size: 100%;
  background: var(--ds-color-surface-base, white);
  box-shadow: var(--ds-shadow-overlay-md, 0 4px 12px rgba(0, 0, 0, 0.1));
}

/* ============================================
   DESKTOP: Collapsed Nav
   ============================================ */

:root[data-shell-mode="desktop"][data-nav-open="false"] .app-shell {
  grid-template-columns: 0 1fr;
}

:root[data-shell-mode="desktop"][data-nav-open="false"] .app-shell-nav {
  inline-size: 0;
  overflow: hidden;
}

/* ============================================
   SAFE AREA (Capacitor/Native)
   ============================================ */

:root[data-shell-mode="mobile"] .app-shell-header {
  padding-block-start: var(--shell-safe-top, 0px);
}

:root[data-shell-mode="mobile"] .app-shell-dock {
  padding-block-end: var(--shell-safe-bottom, 0px);
}

/* ============================================
   DENSITY ADJUSTMENTS
   ============================================ */

:root[data-density="comfortable"] .app-shell-header,
:root[data-density="comfortable"] .app-shell-nav,
:root[data-density="comfortable"] .app-shell-dock {
  /* Touch-friendly spacing - consumers use --ds-space-* tokens */
  --local-density-scale: 1.2;
}

:root[data-density="compact"] .app-shell-header,
:root[data-density="compact"] .app-shell-nav,
:root[data-density="compact"] .app-shell-dock {
  /* Mouse-optimized spacing */
  --local-density-scale: 1;
}

/* ============================================
   REDUCED MOTION
   ============================================ */

@media (prefers-reduced-motion: reduce) {
  .app-shell-nav,
  :root[data-shell-mode]::before {
    transition: none;
    animation: none;
  }
}
